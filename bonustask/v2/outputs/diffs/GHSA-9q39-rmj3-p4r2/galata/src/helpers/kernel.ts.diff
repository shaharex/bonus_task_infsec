--- galata\src\helpers\kernel.ts (old)
+++ galata\src\helpers\kernel.ts (new)
@@ -20,7 +20,8 @@
    */
   async isAnyRunning(): Promise<boolean> {
     return await this.page.evaluate(() => {
-      return !window.jupyterapp.serviceManager.sessions.running().next().done;
+      const app = window.jupyterlab ?? window.jupyterapp;
+      return app.serviceManager.sessions.running().next() !== undefined;
     });
   }
 
@@ -29,7 +30,8 @@
    */
   async shutdownAll(): Promise<void> {
     await this.page.evaluate(async () => {
-      await window.jupyterapp.serviceManager.sessions.shutdownAll();
+      const app = window.jupyterlab ?? window.jupyterapp;
+      await app.serviceManager.sessions.shutdownAll();
     });
 
     await Utils.waitForCondition(async () => {