--- galata\test\jupyterlab\notebook-max-outputs.test.ts (old)
+++ galata\test\jupyterlab\notebook-max-outputs.test.ts (new)
@@ -2,15 +2,13 @@
 // Distributed under the terms of the Modified BSD License.
 
 import { expect, galata, test } from '@jupyterlab/galata';
-
-const MAX_OUTPUTS = 5;
 
 test.use({
   mockSettings: {
     ...galata.DEFAULT_SETTINGS,
     '@jupyterlab/notebook-extension:tracker': {
       ...galata.DEFAULT_SETTINGS['@jupyterlab/notebook-extension:tracker'],
-      maxNumberOutputs: MAX_OUTPUTS
+      maxNumberOutputs: 5
     }
   }
 });
@@ -18,9 +16,10 @@
 test('Limit cell outputs', async ({ page }) => {
   await page.notebook.createNew();
 
-  await page.locator(
-    '.jp-Cell-inputArea >> .cm-editor >> .cm-content[contenteditable="true"]'
-  ).fill(`from IPython.display import display, Markdown
+  await page.waitForSelector('text=| Idle');
+
+  await page.locator('div[role="main"] >> textarea')
+    .fill(`from IPython.display import display, Markdown
 
 for i in range(10):
     display(Markdown('_Markdown_ **text**'))
@@ -28,18 +27,23 @@
 
   await page.notebook.run();
 
-  await expect(page.locator('.jp-RenderedMarkdown')).toHaveCount(MAX_OUTPUTS);
+  await expect(page.locator('.jp-RenderedMarkdown')).toHaveCount(5);
   await expect(page.locator('.jp-TrimmedOutputs')).toHaveText(
-    'Show more outputs'
+    `
+          Output of this cell has been trimmed on the initial display.
+          Displaying the first 5 top outputs.
+          Click on this message to get the complete output.
+`
   );
 });
 
 test("Don't limit cell outputs if input is requested", async ({ page }) => {
   await page.notebook.createNew();
 
-  await page.locator(
-    '.jp-Cell-inputArea >> .cm-editor >> .cm-content[contenteditable="true"]'
-  ).fill(`from IPython.display import display, Markdown
+  await page.waitForSelector('text=| Idle');
+
+  await page.locator('div[role="main"] >> textarea')
+    .fill(`from IPython.display import display, Markdown
 
 for i in range(10):
     display(Markdown('_Markdown_ **text**'))
@@ -48,10 +52,9 @@
 `);
 
   await page.menu.clickMenuItem('Run>Run All Cells');
-  await page.locator('.jp-Stdin >> text=Your age:').waitFor();
-  expect(await page.locator('.jp-RenderedMarkdown').count()).toBeGreaterThan(
-    MAX_OUTPUTS
-  );
+  await page.waitForSelector('.jp-Stdin >> text=Your age:');
+
+  expect(await page.locator('.jp-RenderedMarkdown').count()).toBeGreaterThan(5);
 
   await page.keyboard.press('Enter');
 });
@@ -59,9 +62,10 @@
 test('Display input value', async ({ page }) => {
   await page.notebook.createNew();
 
-  await page.locator(
-    '.jp-Cell-inputArea >> .cm-editor >> .cm-content[contenteditable="true"]'
-  ).fill(`from IPython.display import display, Markdown
+  await page.waitForSelector('text=| Idle');
+
+  await page.locator('div[role="main"] >> textarea')
+    .fill(`from IPython.display import display, Markdown
 
 for i in range(10):
     display(Markdown('_Markdown_ **text**'))
@@ -73,14 +77,12 @@
 `);
 
   await page.menu.clickMenuItem('Run>Run All Cells');
-  await page.locator('.jp-Stdin >> text=Your age:').waitFor();
+  await page.waitForSelector('.jp-Stdin >> text=Your age:');
 
   await page.keyboard.type('42');
   await page.keyboard.press('Enter');
 
-  expect(await page.locator('.jp-RenderedMarkdown').count()).toBeGreaterThan(
-    MAX_OUTPUTS
-  );
+  expect(await page.locator('.jp-RenderedMarkdown').count()).toBeGreaterThan(5);
   await expect(page.locator('.jp-RenderedText').first()).toHaveText(
     'Your age: 42'
   );