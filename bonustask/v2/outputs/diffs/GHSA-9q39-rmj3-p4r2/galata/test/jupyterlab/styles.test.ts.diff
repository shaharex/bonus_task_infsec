--- galata\test\jupyterlab\styles.test.ts (old)
+++ galata\test\jupyterlab\styles.test.ts (new)
@@ -3,7 +3,7 @@
 
 import { expect, test } from '@jupyterlab/galata';
 
-// possibly incomplete (as new tags get added) list of HTML tags as defined in HTML standards (including deprecated elements)
+// posssibly incomplete (as new tags get added) list of HTML tags as defined in HTML standards (including deprecated elements)
 const standardHTMLTags = new Set([
   'a',
   'abbr',
@@ -146,7 +146,7 @@
           await page.theme.setLightTheme();
           break;
         default:
-          expect(false);
+          throw new Error(`Unknown theme ${theme}`);
       }
 
       // Create a new notebook and add a MathJax 2 element to ensure that
@@ -170,7 +170,13 @@
 
       const allTags = new Set([...standardHTMLTags, ...detectedTags]);
 
-      const selectors: string[] = await page.style.collectAllSelectors();
+      const selectors: string[] = await page.evaluate(() =>
+        [...document.querySelectorAll('style')]
+          .map(style => [...style.sheet.cssRules])
+          .flat()
+          .filter((rule: CSSRule) => rule instanceof CSSStyleRule)
+          .map((rule: CSSStyleRule) => rule.selectorText)
+      );
       const matcher = new RegExp(
         ':hover.*\\s+(' + [...allTags].join('|') + ')($|\\s)'
       );
@@ -180,6 +186,14 @@
       for (const selectorGroup of selectors) {
         for (const selector of selectorGroup.split(',')) {
           if (selector.match(matcher)) {
+            if (
+              selector.includes('.bp3-control') ||
+              selector.includes('.bp3-interactive')
+            ) {
+              // Ignore problematic Blueprint styles on 3.4.x - those were removed in 4.0,
+              // and are not as problematic since they only match against `input` and `td`.
+              continue;
+            }
             matchedSelectors.push(selector);
           }
         }