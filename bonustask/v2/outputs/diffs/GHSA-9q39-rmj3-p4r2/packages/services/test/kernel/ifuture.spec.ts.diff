--- packages\services\test\kernel\ifuture.spec.ts (old)
+++ packages\services\test\kernel\ifuture.spec.ts (new)
@@ -1,22 +1,27 @@
 // Copyright (c) Jupyter Development Team.
 // Distributed under the terms of the Modified BSD License.
 
-import { JupyterServer } from '@jupyterlab/testing';
+import { flakyIt as it, JupyterServer } from '@jupyterlab/testutils';
 import { Kernel, KernelAPI, KernelManager, KernelMessage } from '../../src';
 import { KernelTester } from '../utils';
 
+const server = new JupyterServer();
+
+beforeAll(async () => {
+  await server.start();
+});
+
+afterAll(async () => {
+  await server.shutdown();
+});
+
 describe('Kernel.IShellFuture', () => {
-  let server: JupyterServer;
   let tester: KernelTester;
   let kernelManager: KernelManager;
 
-  jest.retryTimes(3);
-
-  beforeAll(async () => {
-    server = new JupyterServer();
-    await server.start();
+  beforeAll(() => {
     kernelManager = new KernelManager();
-  }, 30000);
+  });
 
   afterEach(() => {
     if (tester) {
@@ -27,7 +32,6 @@
   afterAll(async () => {
     const models = await KernelAPI.listRunning();
     await Promise.all(models.map(m => KernelAPI.shutdownKernel(m.id)));
-    await server.shutdown();
   });
 
   it('should have a msg attribute', async () => {
@@ -101,10 +105,8 @@
           calls.push('first');
           // Check to make sure we actually got the messages we expected.
           if (msg.header.msg_type === 'stream') {
-            // eslint-disable-next-line jest/no-conditional-expect
             expect((msg as KernelMessage.IStreamMsg).content.text).toBe('foo');
           } else {
-            // eslint-disable-next-line jest/no-conditional-expect
             expect(
               (msg as KernelMessage.IStatusMsg).content.execution_state
             ).toBe('idle');