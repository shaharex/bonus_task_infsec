--- packages\services\test\terminal\manager.spec.ts (old)
+++ packages\services\test\terminal\manager.spec.ts (new)
@@ -1,7 +1,8 @@
 // Copyright (c) Jupyter Development Team.
 // Distributed under the terms of the Modified BSD License.
 
-import { JupyterServer, testEmission } from '@jupyterlab/testing';
+import { JupyterServer, testEmission } from '@jupyterlab/testutils';
+import { toArray } from '@lumino/algorithm';
 import {
   ServerConnection,
   Terminal,
@@ -13,30 +14,30 @@
 
 beforeAll(async () => {
   await server.start();
-}, 30000);
+});
 
 afterAll(async () => {
   await server.shutdown();
 });
 
 describe('terminal', () => {
+  let manager: Terminal.IManager;
+
+  beforeEach(async () => {
+    manager = new TerminalManager({ standby: 'never' });
+    await manager.ready;
+  });
+
+  afterEach(() => {
+    manager.dispose();
+  });
+
   afterAll(async () => {
     const models = await TerminalAPI.listRunning();
     await Promise.all(models.map(m => TerminalAPI.shutdownTerminal(m.name)));
   });
 
   describe('TerminalManager', () => {
-    let manager: Terminal.IManager;
-
-    beforeEach(async () => {
-      manager = new TerminalManager({ standby: 'never' });
-      await manager.ready;
-    });
-
-    afterEach(() => {
-      manager.dispose();
-    });
-
     describe('#constructor()', () => {
       it('should accept no options', async () => {
         const manager = new TerminalManager({ standby: 'never' });
@@ -79,8 +80,8 @@
     });
 
     describe('#ready', () => {
-      it('should resolve when the manager is ready', async () => {
-        await expect(manager.ready).resolves.not.toThrow();
+      it('should resolve when the manager is ready', () => {
+        return manager.ready;
       });
     });
 
@@ -94,7 +95,7 @@
       it('should give an iterator over the list of running models', async () => {
         await TerminalAPI.startNew();
         await manager.refreshRunning();
-        const running = Array.from(manager.running());
+        const running = toArray(manager.running());
         expect(running.length).toBeGreaterThan(0);
       });
     });
@@ -147,7 +148,7 @@
         const emission = testEmission(manager.runningChanged, {
           test: (sender, args) => {
             expect(sender).toBe(manager);
-            expect(Array.from(args).length).toBeGreaterThan(0);
+            expect(toArray(args).length).toBeGreaterThan(0);
           }
         });
         await manager.startNew();
@@ -157,10 +158,10 @@
 
     describe('#refreshRunning()', () => {
       it('should update the running session models', async () => {
-        const before = Array.from(manager.running()).length;
+        const before = toArray(manager.running()).length;
         const model = await TerminalAPI.startNew();
         await manager.refreshRunning();
-        const running = Array.from(manager.running());
+        const running = toArray(manager.running());
         expect(running.length).toBe(before + 1);
         let found = false;
         running.map(m => {
@@ -172,74 +173,4 @@
       });
     });
   });
-
-  describe('NoopManager', () => {
-    let manager: TerminalManager.NoopManager;
-
-    beforeEach(async () => {
-      manager = new TerminalManager.NoopManager({ standby: 'never' });
-      await manager.parentReady;
-    });
-
-    afterEach(() => {
-      manager.dispose();
-    });
-
-    describe('#constructor()', () => {
-      it('should take the options as an argument', async () => {
-        manager.dispose();
-        manager = new TerminalManager.NoopManager({
-          standby: 'never'
-        });
-        await manager.parentReady;
-        expect(manager instanceof TerminalManager.NoopManager).toBe(true);
-      });
-    });
-
-    describe('#serverSettings', () => {
-      it('should get the server settings', async () => {
-        manager.dispose();
-        const serverSettings = ServerConnection.makeSettings();
-        const standby = 'never';
-        const token = serverSettings.token;
-        manager = new TerminalManager.NoopManager({ serverSettings, standby });
-        await manager.parentReady;
-        expect(manager.serverSettings.token).toBe(token);
-      });
-    });
-
-    describe('#running()', () => {
-      it('should get the running sessions', async () => {
-        await manager.refreshRunning();
-        expect(Array.from(manager.running()).length).toEqual(0);
-      });
-    });
-
-    describe('#refreshRunning()', () => {
-      it('should update the running kernels', async () => {
-        await manager.refreshRunning();
-        expect(Array.from(manager.running()).length).toEqual(0);
-      });
-    });
-
-    describe('#startNew()', () => {
-      it('should throw an error', () => {
-        return expect(manager.startNew()).rejects.toThrow();
-      });
-    });
-
-    describe('#connectTo()', () => {
-      it('should throw an error', () => {
-        return expect(() => {
-          manager.connectTo({ model: { name: 'abcd' } });
-        }).toThrow();
-      });
-    });
-
-    describe('shutdown()', () => {
-      it('should throw an error', () => {
-        return expect(manager.shutdown('1234')).rejects.toThrow();
-      });
-    });
-  });
 });