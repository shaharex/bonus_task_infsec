--- packages\debugger\src\handler.ts (old)
+++ packages\debugger\src\handler.ts (new)
@@ -2,20 +2,38 @@
 // Distributed under the terms of the Modified BSD License.
 
 import { JupyterFrontEnd } from '@jupyterlab/application';
-import { ISessionContext, SessionContext } from '@jupyterlab/apputils';
+
+import {
+  ISessionContext,
+  SessionContext,
+  ToolbarButton
+} from '@jupyterlab/apputils';
+
 import { ConsolePanel } from '@jupyterlab/console';
+
 import { IChangedArgs } from '@jupyterlab/coreutils';
+
 import { DocumentWidget } from '@jupyterlab/docregistry';
+
 import { FileEditor } from '@jupyterlab/fileeditor';
+
 import { NotebookPanel } from '@jupyterlab/notebook';
+
 import { Kernel, KernelMessage, Session } from '@jupyterlab/services';
+
 import { ITranslator, nullTranslator } from '@jupyterlab/translation';
-import { bugDotIcon, bugIcon, ToolbarButton } from '@jupyterlab/ui-components';
+
+import { bugDotIcon, bugIcon } from '@jupyterlab/ui-components';
+
 import { Debugger } from './debugger';
+
+import { IDebugger } from './tokens';
+
 import { ConsoleHandler } from './handlers/console';
+
 import { FileHandler } from './handlers/file';
+
 import { NotebookHandler } from './handlers/notebook';
-import { IDebugger } from './tokens';
 
 const TOOLBAR_DEBUGGER_ITEM = 'debugger-icon';
 
@@ -134,6 +152,7 @@
       _: Session.ISessionConnection,
       status: Kernel.Status
     ): void => {
+      // FIXME-TRANS: Localizable?
       if (status.endsWith('restarting')) {
         void this.updateWidget(widget, connection);
       }
@@ -150,10 +169,11 @@
       msg: KernelMessage.IIOPubMessage
     ): void => {
       if (
+        msg.parent_header != {} &&
+        (msg.parent_header as KernelMessage.IHeader).msg_type ==
+          'execute_request' &&
         this._service.isStarted &&
-        !this._service.hasStoppedThreads() &&
-        (msg.parent_header as KernelMessage.IHeader).msg_type ===
-          'execute_request'
+        !this._service.hasStoppedThreads()
       ) {
         void this._service.displayDefinedVariables();
       }
@@ -185,8 +205,9 @@
       void this.update(widget, connection);
     };
 
-    const contextKernelChangedHandlers =
-      this._contextKernelChangedHandlers[widget.id];
+    const contextKernelChangedHandlers = this._contextKernelChangedHandlers[
+      widget.id
+    ];
 
     if (contextKernelChangedHandlers) {
       sessionContext.kernelChanged.disconnect(contextKernelChangedHandlers);
@@ -358,10 +379,7 @@
 
     // update the active debug session
     if (!this._service.session) {
-      this._service.session = new Debugger.Session({
-        connection,
-        config: this._service.config
-      });
+      this._service.session = new Debugger.Session({ connection });
     } else {
       this._previousConnection = this._service.session!.connection?.kernel
         ? this._service.session.connection