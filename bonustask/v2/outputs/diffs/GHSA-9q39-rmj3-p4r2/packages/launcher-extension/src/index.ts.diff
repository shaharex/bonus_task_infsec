--- packages\launcher-extension\src\index.ts (old)
+++ packages\launcher-extension\src\index.ts (new)
@@ -11,11 +11,10 @@
   JupyterFrontEndPlugin
 } from '@jupyterlab/application';
 import { ICommandPalette, MainAreaWidget } from '@jupyterlab/apputils';
-import { FileBrowserModel, IDefaultFileBrowser } from '@jupyterlab/filebrowser';
 import { ILauncher, Launcher, LauncherModel } from '@jupyterlab/launcher';
 import { ITranslator } from '@jupyterlab/translation';
-import { addIcon, launcherIcon } from '@jupyterlab/ui-components';
-import { find } from '@lumino/algorithm';
+import { launcherIcon } from '@jupyterlab/ui-components';
+import { toArray } from '@lumino/algorithm';
 import { JSONObject } from '@lumino/coreutils';
 import { DockPanel, TabBar, Widget } from '@lumino/widgets';
 
@@ -32,9 +31,8 @@
 const plugin: JupyterFrontEndPlugin<ILauncher> = {
   activate,
   id: '@jupyterlab/launcher-extension:plugin',
-  description: 'Provides the launcher tab service.',
   requires: [ITranslator],
-  optional: [ILabShell, ICommandPalette, IDefaultFileBrowser],
+  optional: [ILabShell, ICommandPalette],
   provides: ILauncher,
   autoStart: true
 };
@@ -51,8 +49,7 @@
   app: JupyterFrontEnd,
   translator: ITranslator,
   labShell: ILabShell | null,
-  palette: ICommandPalette | null,
-  defaultBrowser: IDefaultFileBrowser | null
+  palette: ICommandPalette | null
 ): ILauncher {
   const { commands, shell } = app;
   const trans = translator.load('jupyterlab');
@@ -60,16 +57,11 @@
 
   commands.addCommand(CommandIDs.create, {
     label: trans.__('New Launcher'),
-    icon: args => (args.toolbar ? addIcon : undefined),
     execute: (args: JSONObject) => {
-      const cwd = (args['cwd'] as string) ?? defaultBrowser?.model.path ?? '';
+      const cwd = args['cwd'] ? String(args['cwd']) : '';
       const id = `launcher-${Private.id++}`;
       const callback = (item: Widget) => {
-        // If widget is attached to the main area replace the launcher
-        if (find(shell.widgets('main'), w => w === item)) {
-          shell.add(item, 'main', { ref: id });
-          launcher.dispose();
-        }
+        shell.add(item, 'main', { ref: id });
       };
       const launcher = new Launcher({
         model,
@@ -86,7 +78,7 @@
       const main = new MainAreaWidget({ content: launcher });
 
       // If there are any other widgets open, remove the launcher close icon.
-      main.title.closable = !!Array.from(shell.widgets('main')).length;
+      main.title.closable = !!toArray(shell.widgets('main')).length;
       main.id = id;
 
       shell.add(main, 'main', {
@@ -97,40 +89,13 @@
       if (labShell) {
         labShell.layoutModified.connect(() => {
           // If there is only a launcher open, remove the close icon.
-          main.title.closable = Array.from(labShell.widgets('main')).length > 1;
+          main.title.closable = toArray(labShell.widgets('main')).length > 1;
         }, main);
-      }
-
-      if (defaultBrowser) {
-        const onPathChanged = (model: FileBrowserModel) => {
-          launcher.cwd = model.path;
-        };
-        defaultBrowser.model.pathChanged.connect(onPathChanged);
-        launcher.disposed.connect(() => {
-          defaultBrowser.model.pathChanged.disconnect(onPathChanged);
-        });
       }
 
       return main;
     }
   });
-
-  if (labShell) {
-    void Promise.all([app.restored, defaultBrowser?.model.restored]).then(
-      () => {
-        function maybeCreate() {
-          // Create a launcher if there are no open items.
-          if (labShell!.isEmpty('main')) {
-            void commands.execute(CommandIDs.create);
-          }
-        }
-        // When layout is modified, create a launcher if there are no open items.
-        labShell.layoutModified.connect(() => {
-          maybeCreate();
-        });
-      }
-    );
-  }
 
   if (palette) {
     palette.addItem({
@@ -146,7 +111,10 @@
       const ref =
         arg.currentTitle?.owner.id ||
         arg.titles[arg.titles.length - 1].owner.id;
-
+      if (commands.hasCommand('filebrowser:create-main-launcher')) {
+        // If a file browser is defined connect the launcher to it
+        return commands.execute('filebrowser:create-main-launcher', { ref });
+      }
       return commands.execute(CommandIDs.create, { ref });
     });
   }