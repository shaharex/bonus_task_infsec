--- packages\console\src\panel.ts (old)
+++ packages\console\src\panel.ts (new)
@@ -5,10 +5,10 @@
   ISessionContext,
   MainAreaWidget,
   SessionContext,
-  SessionContextDialogs
+  sessionContextDialogs
 } from '@jupyterlab/apputils';
 import { IEditorMimeTypeService } from '@jupyterlab/codeeditor';
-import { PathExt, Time } from '@jupyterlab/coreutils';
+import { PathExt, Time, URLExt } from '@jupyterlab/coreutils';
 import {
   IRenderMimeRegistry,
   RenderMimeRegistry
@@ -21,7 +21,6 @@
 import { Message } from '@lumino/messaging';
 import { Panel } from '@lumino/widgets';
 import { CodeConsole } from './widget';
-import type { IConsoleCellExecutor } from './tokens';
 
 /**
  * The class name added to console panels.
@@ -39,7 +38,6 @@
     super({ content: new Panel() });
     this.addClass(PANEL_CLASS);
     let {
-      executor,
       rendermime,
       mimeTypeService,
       path,
@@ -50,21 +48,22 @@
       sessionContext,
       translator
     } = options;
-    this.translator = translator ?? nullTranslator;
+    this.translator = translator || nullTranslator;
     const trans = this.translator.load('jupyterlab');
 
-    const contentFactory = (this.contentFactory = options.contentFactory);
+    const contentFactory = (this.contentFactory =
+      options.contentFactory || ConsolePanel.defaultContentFactory);
     const count = Private.count++;
     if (!path) {
-      path = PathExt.join(basePath || '', `console-${count}-${UUID.uuid4()}`);
+      path = URLExt.join(basePath || '', `console-${count}-${UUID.uuid4()}`);
     }
 
     sessionContext = this._sessionContext =
-      sessionContext ??
+      sessionContext ||
       new SessionContext({
         sessionManager: manager.sessions,
         specsManager: manager.kernelspecs,
-        path: manager.contents.localPath(path),
+        path,
         name: name || trans.__('Console %1', count),
         type: 'console',
         kernelPreference: options.kernelPreference,
@@ -72,27 +71,23 @@
       });
 
     const resolver = new RenderMimeRegistry.UrlResolver({
-      path,
+      session: sessionContext,
       contents: manager.contents
     });
     rendermime = rendermime.clone({ resolver });
 
     this.console = contentFactory.createConsole({
-      executor,
       rendermime,
       sessionContext: sessionContext,
       mimeTypeService,
       contentFactory,
-      modelFactory,
-      translator
+      modelFactory
     });
     this.content.addWidget(this.console);
 
     void sessionContext.initialize().then(async value => {
       if (value) {
-        await (
-          options.sessionDialogs ?? new SessionContextDialogs({ translator })
-        ).selectKernel(sessionContext!);
+        await sessionContextDialogs.selectKernel(sessionContext!);
       }
       this._connected = new Date();
       this._updateTitlePanel();
@@ -140,7 +135,7 @@
   protected onActivateRequest(msg: Message): void {
     const prompt = this.console.promptCell;
     if (prompt) {
-      prompt.editor!.focus();
+      prompt.editor.focus();
     }
   }
 
@@ -192,11 +187,6 @@
     contentFactory: IContentFactory;
 
     /**
-     * Console cell executor
-     */
-    executor?: IConsoleCellExecutor;
-
-    /**
      * The service manager used by the panel.
      */
     manager: ServiceManager.IManager;
@@ -225,11 +215,6 @@
      * An existing session context to use.
      */
     sessionContext?: ISessionContext;
-
-    /**
-     * Session dialogs to use.
-     */
-    sessionDialogs?: ISessionContext.IDialogs;
 
     /**
      * The model factory for the console widget.
@@ -267,8 +252,7 @@
    */
   export class ContentFactory
     extends CodeConsole.ContentFactory
-    implements IContentFactory
-  {
+    implements IContentFactory {
     /**
      * Create a new console panel.
      */
@@ -288,12 +272,18 @@
   }
 
   /**
+   * A default code console content factory.
+   */
+  export const defaultContentFactory: IContentFactory = new ContentFactory();
+
+  /* tslint:disable */
+  /**
    * The console renderer token.
    */
   export const IContentFactory = new Token<IContentFactory>(
-    '@jupyterlab/console:IContentFactory',
-    'A factory object that creates new code consoles. Use this if you want to create and host code consoles in your own UI elements.'
+    '@jupyterlab/console:IContentFactory'
   );
+  /* tslint:enable */
 }
 
 /**
@@ -313,7 +303,7 @@
     connected: Date | null,
     executed: Date | null,
     translator?: ITranslator
-  ): void {
+  ) {
     translator = translator || nullTranslator;
     const trans = translator.load('jupyterlab');
 