--- packages\codeeditor\src\jsoneditor.ts (old)
+++ packages\codeeditor\src\jsoneditor.ts (new)
@@ -2,7 +2,6 @@
 // Distributed under the terms of the Modified BSD License.
 
 import { IObservableJSON } from '@jupyterlab/observables';
-import { ISharedText, SourceChange } from '@jupyter/ydoc';
 import {
   ITranslator,
   nullTranslator,
@@ -74,17 +73,14 @@
     this.node.appendChild(this.headerNode);
     this.node.appendChild(this.editorHostNode);
 
-    const model = new CodeEditor.Model({ mimeType: 'application/json' });
-    model.sharedModel.changed.connect(this._onModelChanged, this);
-
+    const model = new CodeEditor.Model();
+
+    model.value.text = this._trans.__('No data!');
+    model.mimeType = 'application/json';
+    model.value.changed.connect(this._onValueChanged, this);
     this.model = model;
-    this.editor = options.editorFactory({
-      host: this.editorHostNode,
-      model,
-      config: {
-        readOnly: true
-      }
-    });
+    this.editor = options.editorFactory({ host: this.editorHostNode, model });
+    this.editor.setOption('readOnly', true);
   }
 
   /**
@@ -153,7 +149,8 @@
       return;
     }
 
-    this.source?.dispose();
+    // The model does not dispose the shared model by default
+    this.model.sharedModel.dispose();
     this.model.dispose();
     this.editor.dispose();
 
@@ -193,6 +190,23 @@
     this.revertButtonNode.hidden = true;
     this.commitButtonNode.hidden = true;
     this.headerNode.addEventListener('click', this);
+    if (this.isVisible) {
+      this.update();
+    }
+  }
+
+  /**
+   * Handle `after-show` messages for the widget.
+   */
+  protected onAfterShow(msg: Message): void {
+    this.update();
+  }
+
+  /**
+   * Handle `update-request` messages for the widget.
+   */
+  protected onUpdateRequest(msg: Message): void {
+    this.editor.refresh();
   }
 
   /**
@@ -225,22 +239,20 @@
   /**
    * Handle change events.
    */
-  private _onModelChanged(model: ISharedText, change: SourceChange): void {
-    if (change.sourceChange) {
-      let valid = true;
-      try {
-        const value = JSON.parse(this.editor.model.sharedModel.getSource());
-        this.removeClass(ERROR_CLASS);
-        this._inputDirty =
-          !this._changeGuard && !JSONExt.deepEqual(value, this._originalValue);
-      } catch (err) {
-        this.addClass(ERROR_CLASS);
-        this._inputDirty = true;
-        valid = false;
-      }
-      this.revertButtonNode.hidden = !this._inputDirty;
-      this.commitButtonNode.hidden = !valid || !this._inputDirty;
-    }
+  private _onValueChanged(): void {
+    let valid = true;
+    try {
+      const value = JSON.parse(this.editor.model.value.text);
+      this.removeClass(ERROR_CLASS);
+      this._inputDirty =
+        !this._changeGuard && !JSONExt.deepEqual(value, this._originalValue);
+    } catch (err) {
+      this.addClass(ERROR_CLASS);
+      this._inputDirty = true;
+      valid = false;
+    }
+    this.revertButtonNode.hidden = !this._inputDirty;
+    this.commitButtonNode.hidden = !valid || !this._inputDirty;
   }
 
   /**
@@ -278,7 +290,7 @@
   private _mergeContent(): void {
     const model = this.editor.model;
     const old = this._originalValue;
-    const user = JSON.parse(model.sharedModel.getSource()) as JSONObject;
+    const user = JSON.parse(model.value.text) as JSONObject;
     const source = this.source;
     if (!source) {
       return;
@@ -312,17 +324,18 @@
     const content = this._source ? this._source.toJSON() : {};
     this._changeGuard = true;
     if (content === void 0) {
-      model.sharedModel.setSource(this._trans.__('No data!'));
+      model.value.text = this._trans.__('No data!');
       this._originalValue = JSONExt.emptyObject;
     } else {
       const value = JSON.stringify(content, null, 4);
-      model.sharedModel.setSource(value);
+      model.value.text = value;
       this._originalValue = content;
       // Move the cursor to within the brace.
       if (value.length > 1 && value[0] === '{') {
         this.editor.setCursorPosition({ line: 0, column: 1 });
       }
     }
+    this.editor.refresh();
     this._changeGuard = false;
     this.commitButtonNode.hidden = true;
     this.revertButtonNode.hidden = true;