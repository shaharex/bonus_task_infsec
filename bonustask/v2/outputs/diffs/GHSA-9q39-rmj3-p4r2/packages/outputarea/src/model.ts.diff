--- packages\outputarea\src\model.ts (old)
+++ packages\outputarea\src\model.ts (new)
@@ -4,7 +4,7 @@
 import * as nbformat from '@jupyterlab/nbformat';
 import { IObservableList, ObservableList } from '@jupyterlab/observables';
 import { IOutputModel, OutputModel } from '@jupyterlab/rendermime';
-import { map } from '@lumino/algorithm';
+import { each, map, toArray } from '@lumino/algorithm';
 import { JSONExt } from '@lumino/coreutils';
 import { IDisposable } from '@lumino/disposable';
 import { ISignal, Signal } from '@lumino/signaling';
@@ -14,14 +14,12 @@
  */
 export interface IOutputAreaModel extends IDisposable {
   /**
-   * A signal emitted when the output item changes.
-   *
-   * The number is the index of the output that changed.
-   */
-  readonly stateChanged: ISignal<IOutputAreaModel, number>;
-
-  /**
-   * A signal emitted when the list of items changes.
+   * A signal emitted when the model state changes.
+   */
+  readonly stateChanged: ISignal<IOutputAreaModel, void>;
+
+  /**
+   * A signal emitted when the model changes.
    */
   readonly changed: ISignal<IOutputAreaModel, IOutputAreaModel.ChangedArgs>;
 
@@ -80,6 +78,11 @@
    * Serialize the model to JSON.
    */
   toJSON(): nbformat.IOutput[];
+
+  /**
+   * The maximum number of output items to display on top and bottom of cell output.
+   */
+  maxNumberOutputs?: number;
 }
 
 /**
@@ -137,26 +140,24 @@
       options.contentFactory || OutputAreaModel.defaultContentFactory;
     this.list = new ObservableList<IOutputModel>();
     if (options.values) {
-      for (const value of options.values) {
-        const index = this._add(value) - 1;
-        const item = this.list.get(index);
-        item.changed.connect(this._onGenericChange, this);
-      }
+      each(options.values, value => {
+        this._add(value);
+      });
     }
     this.list.changed.connect(this._onListChanged, this);
   }
 
   /**
-   * A signal emitted when an item changes.
-   */
-  get stateChanged(): ISignal<IOutputAreaModel, number> {
+   * A signal emitted when the model state changes.
+   */
+  get stateChanged(): ISignal<IOutputAreaModel, void> {
     return this._stateChanged;
   }
 
   /**
-   * A signal emitted when the list of items changes.
-   */
-  get changed(): ISignal<IOutputAreaModel, IOutputAreaModel.ChangedArgs> {
+   * A signal emitted when the model changes.
+   */
+  get changed(): ISignal<this, IOutputAreaModel.ChangedArgs> {
     return this._changed;
   }
 
@@ -186,11 +187,11 @@
     }
     const trusted = (this._trusted = value);
     for (let i = 0; i < this.list.length; i++) {
-      const oldItem = this.list.get(i);
-      const value = oldItem.toJSON();
-      const item = this._createItem({ value, trusted });
+      let item = this.list.get(i);
+      const value = item.toJSON();
+      item.dispose();
+      item = this._createItem({ value, trusted });
       this.list.set(i, item);
-      oldItem.dispose();
     }
   }
 
@@ -266,9 +267,9 @@
       this.clearNext = true;
       return;
     }
-    for (const item of this.list) {
+    each(this.list, (item: IOutputModel) => {
       item.dispose();
-    }
+    });
     this.list.clear();
   }
 
@@ -278,26 +279,22 @@
    * #### Notes
    * This will clear any existing data.
    */
-  fromJSON(values: nbformat.IOutput[]): void {
+  fromJSON(values: nbformat.IOutput[]) {
     this.clear();
-    for (const value of values) {
+    each(values, value => {
       this._add(value);
-    }
+    });
   }
 
   /**
    * Serialize the model to JSON.
    */
   toJSON(): nbformat.IOutput[] {
-    return Array.from(
-      map(this.list, (output: IOutputModel) => output.toJSON())
-    );
+    return toArray(map(this.list, (output: IOutputModel) => output.toJSON()));
   }
 
   /**
    * Add a copy of the item to the list.
-   *
-   * @returns The list length
    */
   private _add(value: nbformat.IOutput): number {
     const trusted = this._trusted;
@@ -325,9 +322,9 @@
       const item = this._createItem({ value, trusted });
       const index = this.length - 1;
       const prev = this.list.get(index);
+      prev.dispose();
       this.list.set(index, item);
-      prev.dispose();
-      return this.length;
+      return index;
     }
 
     if (nbformat.isStream(value)) {
@@ -358,7 +355,7 @@
   protected shouldCombine(options: {
     value: nbformat.IOutput;
     lastModel: IOutputModel;
-  }): boolean {
+  }) {
     return true;
   }
 
@@ -380,6 +377,7 @@
   private _createItem(options: IOutputModel.IOptions): IOutputModel {
     const factory = this.contentFactory;
     const item = factory.createOutputModel(options);
+    item.changed.connect(this._onGenericChange, this);
     return item;
   }
 
@@ -390,61 +388,22 @@
     sender: IObservableList<IOutputModel>,
     args: IObservableList.IChangedArgs<IOutputModel>
   ) {
-    switch (args.type) {
-      case 'add':
-        args.newValues.forEach(item => {
-          item.changed.connect(this._onGenericChange, this);
-        });
-        break;
-      case 'remove':
-        args.oldValues.forEach(item => {
-          item.changed.disconnect(this._onGenericChange, this);
-        });
-        break;
-      case 'set':
-        args.newValues.forEach(item => {
-          item.changed.connect(this._onGenericChange, this);
-        });
-        args.oldValues.forEach(item => {
-          item.changed.disconnect(this._onGenericChange, this);
-        });
-        break;
-    }
     this._changed.emit(args);
   }
 
   /**
    * Handle a change to an item.
    */
-  private _onGenericChange(itemModel: IOutputModel): void {
-    let idx: number;
-    let item: IOutputModel | null = null;
-    for (idx = 0; idx < this.list.length; idx++) {
-      item = this.list.get(idx);
-      if (item === itemModel) {
-        break;
-      }
-    }
-    if (item != null) {
-      this._stateChanged.emit(idx);
-      this._changed.emit({
-        type: 'set',
-        newIndex: idx,
-        oldIndex: idx,
-        oldValues: [item],
-        newValues: [item]
-      });
-    }
-  }
-
-  private _lastStream = '';
+  private _onGenericChange(): void {
+    this._stateChanged.emit(void 0);
+  }
+
+  private _lastStream: string;
   private _lastName: 'stdout' | 'stderr';
   private _trusted = false;
   private _isDisposed = false;
-  private _stateChanged = new Signal<OutputAreaModel, number>(this);
-  private _changed = new Signal<OutputAreaModel, IOutputAreaModel.ChangedArgs>(
-    this
-  );
+  private _stateChanged = new Signal<IOutputAreaModel, void>(this);
+  private _changed = new Signal<this, IOutputAreaModel.ChangedArgs>(this);
 }
 
 /**