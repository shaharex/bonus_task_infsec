--- packages\notebook\src\modelfactory.ts (old)
+++ packages\notebook\src\modelfactory.ts (new)
@@ -1,8 +1,9 @@
 // Copyright (c) Jupyter Development Team.
 // Distributed under the terms of the Modified BSD License.
 
-import type { ISharedNotebook } from '@jupyter/ydoc';
+import { CodeCellModel } from '@jupyterlab/cells';
 import { DocumentRegistry } from '@jupyterlab/docregistry';
+import { IModelDB } from '@jupyterlab/observables';
 import { Contents } from '@jupyterlab/services';
 import { INotebookModel, NotebookModel } from './model';
 
@@ -10,16 +11,24 @@
  * A model factory for notebooks.
  */
 export class NotebookModelFactory
-  implements DocumentRegistry.IModelFactory<INotebookModel>
-{
+  implements DocumentRegistry.IModelFactory<INotebookModel> {
   /**
    * Construct a new notebook model factory.
    */
-  constructor(options: NotebookModelFactory.IOptions = {}) {
+  constructor(options: NotebookModelFactory.IOptions) {
+    this._collaborative = options.collaborative ?? true;
     this._disableDocumentWideUndoRedo =
       options.disableDocumentWideUndoRedo ?? true;
-    this._collaborative = options.collaborative ?? true;
+    const codeCellContentFactory = options.codeCellContentFactory;
+    this.contentFactory =
+      options.contentFactory ||
+      new NotebookModel.ContentFactory({ codeCellContentFactory });
   }
+
+  /**
+   * The content model factory used by the NotebookModelFactory.
+   */
+  readonly contentFactory: NotebookModel.IContentFactory;
 
   /**
    * Define the disableDocumentWideUndoRedo property.
@@ -79,17 +88,26 @@
   /**
    * Create a new model for a given path.
    *
-   * @param options Model options.
+   * @param languagePreference - An optional kernel language preference.
+   * @param modelDB - An optional model storage.
+   * @param isInitialized - Whether the model is initialized or not.
+   * @param collaborationEnabled - Whether collaboration is enabled at the application level or not (default `false`).
    *
    * @returns A new document model.
    */
   createNew(
-    options: DocumentRegistry.IModelOptions<ISharedNotebook> = {}
+    languagePreference?: string,
+    modelDB?: IModelDB,
+    isInitialized?: boolean,
+    collaborationEnabled?: boolean
   ): INotebookModel {
+    const contentFactory = this.contentFactory;
     return new NotebookModel({
-      languagePreference: options.languagePreference,
-      sharedModel: options.sharedModel,
-      collaborationEnabled: options.collaborationEnabled && this.collaborative,
+      languagePreference,
+      contentFactory,
+      collaborationEnabled: collaborationEnabled && this.collaborative,
+      modelDB,
+      isInitialized,
       disableDocumentWideUndoRedo: this._disableDocumentWideUndoRedo
     });
   }
@@ -105,6 +123,7 @@
    * Defines if the document can be undo/redo.
    */
   private _disableDocumentWideUndoRedo: boolean;
+
   private _disposed = false;
   private _collaborative: boolean;
 }
@@ -131,5 +150,16 @@
      * @alpha
      */
     disableDocumentWideUndoRedo?: boolean;
+
+    /**
+     * The factory for code cell content.
+     */
+    codeCellContentFactory?: CodeCellModel.IContentFactory;
+
+    /**
+     * The content factory used by the NotebookModelFactory.  If
+     * given, it will supersede the `codeCellContentFactory`.
+     */
+    contentFactory?: NotebookModel.IContentFactory;
   }
 }